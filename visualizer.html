<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Visualizer</title>
        <style>
            body{margin: 0;}
            <canvas width=100% height=100%></canvas>
        </style>
    </head>
    <body>
    <script src=three.min.js></script>
    <script type="text/javascript">

      colorSpace = {

          BLUE : 0x0000FF,
          RED : 0xFF0000,
          YELLOW: 0xFFFF00,
          GREEN: 0x00FF00

      }



        var ambLight = new THREE.AmbientLight(0x404040);
        var skyLight = new THREE.PointLight(0x404040,2,0);
        var skyLight2 = new THREE.PointLight(0x404040,2,0);
        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight, 0.1,1000.0);
        var renderer = new THREE.WebGLRenderer();

        renderer.setSize(window.innerWidth,window.innerHeight);
        document.body.appendChild(renderer.domElement);

        var geometry = null;
        var material = null;
        var nodes = [];
        var connections = [];

        function generateNodes(count) {
            geometry = new THREE.DodecahedronGeometry( 2, 0);
            material = new THREE.MeshLambertMaterial( {color: colorSpace.RED, shading: THREE.SmoothShading} );
            for (var x = 0; x<count; x++){
                nodes.push(new THREE.Mesh( geometry, material ));
            }
            geometry = null;
            material = null;
        }
        //call last after all translations
        function generateConnections(objs) {
            for (var index = 0; index < (objs.length)-1; index++){
                var next = index + 1;
                var deltaX = objs[index].position.x-objs[next].position.x;
                var deltaY = objs[index].position.y-objs[next].position.y;
                var distance = Math.sqrt(Math.pow(deltaX,2) + Math.pow(deltaY,2));
                var midX = (objs[index].position.x + objs[next].position.x)/2;
                var midY = (objs[index].position.y + objs[next].position.y)/2;

                geometry = new THREE.CylinderGeometry(radiusTop=.25,radiusBottom=.25,height=distance);
                material = new THREE.MeshLambertMaterial( {color: colorSpace.BLUE, shading: THREE.SmoothShading});
                connections.push(new THREE.Mesh( geometry, material ));

                var theta = Math.acos((objs[index].position.x - midX)/(distance/2));
                var mu = (3.1415/2) - theta;

                if(objs[index].position.y >= 0 && objs[index].position.x <=0 || (objs[index].position.y >= 0 && objs[index].position.x >= 0) ) {
                    connections[index].rotation.z -= mu;
                } else {
                    connections[index].rotation.z += mu;
                }

                connections[index].position.set(midX,midY, objs[index].position.z);
                scene.add(connections[index]);
            }
            geometry = null;
            material = null;
        }

        skyLight.position.set(-10,10,20);
        skyLight2.position.set(10,10,20);

        scene.add(ambLight);
        scene.add(skyLight);
        scene.add(skyLight2);


        generateNodes(4);

        for(index in nodes) {
            scene.add(nodes[index])
        }


        nodes[0].translateX(25);
        nodes[0].translateY(-10);
        nodes[1].translateX(-10);
        nodes[1].translateY(15);
        nodes[2].translateX(10);
        nodes[2].translateY(-10);
        nodes[3].translateX(-25);
        nodes[3].translateY(-10);

        generateConnections(nodes);

        camera.position.z = 45;

        function drawScene(){
            for(index in nodes) {
                nodes[index].rotation.x += 0.05;
                nodes[index].rotation.y += .025;
            }
            scene.rotation.y += .015;
            requestAnimationFrame(drawScene);
            renderer.render(scene,camera);
        }
        drawScene();
    </script>
    </body>
</html>
